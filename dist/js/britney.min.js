"use strict";angular.module("britney",[]),angular.module("britney").factory("Flasher",["$rootScope",function(a){function b(b){-1===j.indexOf(b.severity)&&delete b.severity,b=angular.extend({},l,b),b.id=g("notification_"),a.$broadcast(i,b)}function c(a){b(f(a))}function d(a){var c=f(a);angular.extend(c,k),b(c)}function e(a,b){m.push([b,f(a)])}function f(a){var b={};return a.message&&(b.message=a.message),a.severity&&(b.severity=a.severity),a.sticky&&(b.sticky=a.sticky),b}function g(a){return a+n++}function h(a){for(var c,d,e;m.length>0;)c=m.pop(),d=c[0],e=c[1],d===a&&b(e)}var i="event:add-notification",j=["info","success","warning"],k={sticky:!0},l={sticky:!1,severity:"info"},m=[],n=0;return{showFlashNotification:c,showStickyNotification:d,rigRouteNotification:e,_dispatchRiggedNotifications:h}}]).run(["$rootScope","Flasher",function(a,b){a.$on("$stateChangeSuccess",function(a,c){b._dispatchRiggedNotifications(c.name)})}]),angular.module("britney").controller("FlasherCtrl",["$scope","$rootScope","$timeout",function(a,b,c){function d(b){delete a.notifications[b]}function e(a){function b(){return angular.isString(a.id)&&0===a.id.indexOf("notification_")}return b()&&angular.isString(a.message)&&angular.isString(a.severity)&&"boolean"==typeof a.sticky}function f(b,f){var g=f.id;e(f)&&(a.notifications[g]=f,f.sticky||c(function(){d(g)},h))}function g(){a.notifications={}}var h=5e3;a.notifications={},a.removeNotification=d,b.$on("event:add-notification",f),b.$on("$stateChangeStart",g)}]),angular.module("britney").directive("britneyFlasher",function(){return{template:'<div class="britney-notifications" ng-controller="FlasherCtrl"><div ng-repeat="(id, notification) in notifications" class="notification {{notification.severity}}" ng-click="removeNotification(id)"><span class="message">{{ notification.message }}</span></div></div>',restrict:"E",replace:!0}});